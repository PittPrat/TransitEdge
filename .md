# ğŸš¦ SmartPath AI

**Agentic, explainable commuter assistant for Seattleâ€“Redmond routes, powered by CrewAI, WSDOT data, Azure Maps, and Retrieval-Augmented Generation (RAG).**

---

## ğŸŒŸ Overview

SmartPath AI is a web-based AI co-pilot that helps commuters, fleets, and transit riders make optimal travel decisions across Seattle, Bellevue, and Redmond. Unlike Google Maps, it provides:

âœ… Real-time congestion & toll-aware routing  
âœ… Multi-modal route personalization (car, transit, micro-mobility)  
âœ… Conversational route explanations with RAG  
âœ… Proactive suggestions based on predicted delays, COâ‚‚ cost, and detours

---

## ğŸ§  Architecture

```text
                      +-------------------+
                      |   React Frontend  |
                      +---------+---------+
                                |
               Ask "Why SR-520 is avoided today?"
                                |
                      +---------v---------+
                      |     FastAPI       |
                      |   /route, /ask    |
                      +---------+---------+
                                |
          +---------------------+----------------------+
          |            CrewAI Agent Stack             |
          |                                            |
          |  +----------------+   +----------------+   |
          |  | RetrievalAgent |â†--|  ChromaDB Tool |   |
          |  +----------------+   +----------------+   |
          |  | ReasoningAgent |--> GPT-4o           |  |
          |  +----------------+                      |  |
          |  | CriticAgent     (optional)           |  |
          +---------------------+----------------------+
                                |
            Pulls from: WSDOT TrafficFlow, GTFS, Redis, Phoenix
Key Components

Role	Tech	Description
Telemetry Agent	WSDOT TrafficFlow API + Redis	Streams per-segment speed data every 90â€¯s
Route Engine	Azure Maps + GTFS	Computes drive-only or multi-modal routes
Policy Agent	LightGBM + COâ‚‚ calc	Predicts travel time, toll cost, emissions
RAG Explainer Agent	CrewAI + Chroma + GPT-4o	Answers â€œWhy this route?â€ questions with live context
Phoenix Logs	Arize Phoenix	Tracks feature logs, predictions, explanations
âš™ï¸ Setup (Local)

ğŸ” 1. Install requirements
pip install -r requirements.txt
npm install --prefix frontend
ğŸ“¥ 2. Set up environment
# .env
WSDOT_API_KEY=43f8f626-3493-4d39-a645-cf86e2443c34
CLAUDE_API_KEY=your_key
AZURE_MAPS_KEY=your_key
PHOENIX_API_KEY=your_key
REDIS_URL=redis://localhost:6379
ğŸ§  3. Build Chroma Index
python index_chunks.py --source data/wsdot_big3_clean.csv
ğŸš€ 4. Run services
docker compose up -d redis
uvicorn api.main:app --reload
npm run dev --prefix frontend
ğŸŒ API Endpoints

Method	Endpoint	Description
POST	/route	Given a trip_id, returns best route w/ ETA, toll, COâ‚‚
GET	/live_speed?seg_id=	Returns real-time mph for a given station
POST	/ask	Passes a natural-language question to the RAG agent
GET	/healthz	Returns API health status
ğŸ’¬ Sample Queries (RAG Agent)

Question	Response Example
â€œWhy avoid SR-520 today?â€	â€œLoop detectors at MPâ€¯3.2 show 17â€¯mph; toll is $3.75. I-90 saves 9â€¯min.â€
â€œWhy did I switch to Bellevue P&R?â€	â€œTransit leg reduced COâ‚‚ by 1.3â€¯kg and avoided $2.50 toll.â€
â€œCan I get a coffee on this route?â€	â€œYes, a Starbucks near NE 8th adds 2â€¯min. Route adjusted.â€
ğŸ”¬ Phoenix Metrics

eta_gain, toll_cost, critic_pass, corridor
feature_missing, detour_flag
response_latency_ms on RAG calls
Visit your Phoenix project dashboard to explore metrics and explanations.

ğŸ§ª Hackathon Demo Flow

# 1. Start telemetry stream
python parse_wsdot_flow.py --csv data/wsdot_big3_clean.csv --stream-redis

# 2. Start backend API
uvicorn api.main:app

# 3. Start frontend (Vite + Azure Maps)
npm run dev --prefix frontend

# 4. Ask:
curl -X POST http://localhost:8000/ask -d '{"q":"Why avoid SR-520 today?"}'

# 5. Open Phoenix observability tab

Use filtered_wsdot_loops.csv to load data
